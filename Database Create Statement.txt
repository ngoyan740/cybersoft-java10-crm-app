CREATE DATABASE IF NOT EXISTS crm;

USE crm;

CREATE TABLE role (
	id 				int AUTO_INCREMENT,
	name			varchar(50) NOT NULL UNIQUE,
	description		varchar(500),
	PRIMARY KEY (id)
);

CREATE TABLE user (
	id				int AUTO_INCREMENT,
	email 			varchar(255) NOT NULL UNIQUE,
	password		varchar(500) NOT NULL,
	
	fullname 		varchar(255),
	avatar 			varchar(500),
	role_id 		int NOT NULL,
	PRIMARY KEY (id) 
);

CREATE TABLE status (
	id 				int AUTO_INCREMENT,
	name			varchar(255) NOT NULL UNIQUE,
	PRIMARY KEY (id)
);

CREATE TABLE task (
	id 				int AUTO_INCREMENT,
	name			varchar(255) NOT NULL UNIQUE,
	
	start_date		date,
	end_date		date,
	
	status_id 		int NOT NULL,
	user_id		 	int NOT NULL,
	project_id 		int NOT NULL,
	
	PRIMARY KEY (id)
);

CREATE TABLE project (
	id 				int AUTO_INCREMENT,
	name			varchar(255) NOT NULL UNIQUE,
	start_date 		date,
	end_date		date,
	PRIMARY KEY (id)
);

ALTER TABLE user ADD CONSTRAINT fk_user_role
			FOREIGN KEY (role_id) REFERENCES role(id);

ALTER TABLE task ADD CONSTRAINT fk_task_status
			FOREIGN KEY (status_id) REFERENCES status(id);
ALTER TABLE task ADD CONSTRAINT fk_task_user
			FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE task ADD CONSTRAINT fk_task_project
			FOREIGN KEY (project_id) REFERENCES project(id);
